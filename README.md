# 채팅 감사 기능 
채팅 이용자 메시지 로그 데이터 수집을 통한 감사 기능 구현

### Data
수집하고자 하는 데이터는 메시지 전송자 `sender`, 전송되는 메시지 `message`, 채팅 종료 여부를 표시하는 `end`, 전송 시간 `timestamp`이며, 데이터를 활용하여 얻고자 하는 통계는 아래와 같다. 
- `user count`: 해당 전송자가 몇 개의 채팅을 전송하였는지 확인 가능 
- `word count`: 해당 단어가 몇 번 사용되었는지 확인 가능
- `time count`: 해당 시,분에 몇 개의 채팅이 전송되었는지 확인 가능


### Audit module
- `offset.txt`: 전송된 메시지의 누수를 방지하고, 데이터 추출의 효율성을 확보하기 위하여 Kafka UI를 통해 확인가능한 `offset` 정보를 저장하여 관리
- `message_audit`: Kafka에서 가져온 데이터를 spark의 데이터 프레임 형식으로 변환한 후, 해당 경로에 parquet 형식으로 누적해서 저장


### Airflow
- `audit.py` DAG: 감사를 위한 데이터 수집 작업은 1시간 마다 스케줄링되어 이루어지며, 이 과정은 `Spark`를 활용하여 분산 처리함 
